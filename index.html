<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<body style="background: #eeee">
<div class="container" style="background: white; height: 500px" onload="CheckPages()">
  <h2 style="padding-top: 20px; margin-top: 20px; margin-bottom: 20px">RFW - Current Status:</h2>
<table class="table table-gray">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">System</th>
      <th scope="col">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th scope="row">1</th>
      <td>Connect Intergration</td>
      <td id="ConnectIntergrationStatus"></td>
    </tr>
    <tr>
      <th scope="row">2</th>
      <td>Lucy</td>
      <td></td>
    </tr>
    <tr>
      <th scope="row">3</th>
      <td>Connect Website</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

<script>


window.onload = function() {
  CheckConnectIntergration()
}

function CheckConnectIntergration() {
$.ajax({
//curl -H "Content-Type: application/json" -X GET -H "X-Auth-Token: 791a0df3-0526-463c-8217-f9702430215a" "https://online.royalfarwest.org.au/app/api/external-emr/filter?page=1&pageSize=100"

       'url' : 'https://online.royalfarwest.org.au/app/api/external-emr/filter?page=1&pageSize=100',
       'type' : 'GET',
       'Content-Type' : 'application/json',
        headers: {
        'X-Auth-Token' : '791a0df3-0526-463c-8217-f9702430215a',
       },
       'success' : function(data) {
           var failed = false
           for (let i = 0; i < data.content.length; i++) {
             //console.log(data.content[i].successful)
             if(data.content[i].successful == false){
               $('#ConnectIntergrationStatus')[0].innerHTML = 'FAILING'
               $('#ConnectIntergrationStatus')[0].style.color = 'red'
               failed = true
               break
             }
           }
           if(failed = false){
             $('#ConnectIntergrationStatus')[0].innerHTML = 'PASSING'
             $('#ConnectIntergrationStatus')[0].style.color = 'Green'
           }
       },
       'error' : function(request,error)
       {
           $('#ConnectIntergrationStatus')[0].innerHTML = 'FAILING'
           $('#ConnectIntergrationStatus')[0].style.color = 'red'
       }
   });
 }
</script>
</body>
